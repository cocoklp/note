[服务](#服务)

[helm](#helm)

[CRI](#CRI)

# 服务

## why

pod可以动态创建和销毁，且每个pod都有自己的ip地址，当pod A为pod B提供服务时，pod B如何找到并跟踪A的ip地址

## what

service通过label来管理pod，servie抽象出地址给其他pod访问。

![20161024200831](https://img.kubernetes.org.cn/2016/10/20161024200831.jpg)



# helm

kubernetes的包管理器，相当于linux中的yum。每个包成为一个chart，是一个目录，一般压缩成tgz格式的文件

开发者：

​	通过helm打包应用，管理应用依赖关系、版本，并发布应用到仓库

使用者：

​	直接安装应用。

## 安装helm

tar -zxvf helm-v2.12.1-linux-amd64.tar.gz cd linux-amd64/ 

// 拷贝helm到 /usr/local/bin

cp helm /usr/local/bin

helm：命令行客户端工具

tiller：helm的服务端。接收helm请求。

chart：软件包

repoistory：helm的软件仓库。

release：通过helm install 命令在kubernetes中部署的chart成为release。实例。

[helm架构](https://images2018.cnblogs.com/blog/892532/201802/892532-20180224212352306-705544441.png)

## 构建镜像

编写chart

```
helm create my-hello-world
helm lint --strict my-hello-world
helm package my-hello-world/
helm install my-hello-world-chart-test my-hello-world-0.1.tgz
kubectl port-forward my-hello-world-chart-test1-766d67b74c-7mb76 8080:80
```



```
├── charts
├── Chart.yaml
├── templates
│   ├── deployment.yaml
│   ├── _helpers.tpl
│   ├── ingress.yaml
│   ├── NOTES.txt
│   ├── serviceaccount.yaml
│   ├── service.yaml
│   └── tests
│       └── test-connection.yaml
└── values.yaml
```

### Chart.yml

 当前chart的名称，版本等信息

```
apiVersion: v2
name: my-hello-world
description: A Helm chart for Kubernetes

# A chart can be either an 'application' or a 'library' chart.
#
# Application charts are a collection of templates that can be packaged into versioned archives
# to be deployed.
#
# Library charts provide useful utilities or functions for the chart developer. They're included as
# a dependency of application charts to inject those utilities and functions into the rendering
# pipeline. Library charts do not define any templates and therefore cannot be deployed.
type: application

# This is the chart version. This version number should be incremented each time you make changes
# to the chart and its templates, including the app version.
version: 0.1.0

# This is the version number of the application being deployed. This version number should be
# incremented each time you make changes to the application.
appVersion: 1.16.0
```





























# CRI

容器运行时接口。k8s提供的api，用于同容器运行时进行通信以创建/删除容器化应用程序。

容器运行时：容器从拉取镜像到启动运行再到终止的整个生命周期。

# OCI

OCI运行时负责使用linux内核系统调用生成容器。